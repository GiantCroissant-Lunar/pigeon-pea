{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/GiantCroissant-Lunar/pigeon-pea/schemas/skill.schema.json",
  "title": "Skill Front-Matter Schema",
  "description": "Validates YAML front-matter in SKILL.md files. Skills are atomic, reusable capabilities that agents can invoke to perform specific tasks.",
  "type": "object",
  "required": ["name", "version", "kind", "description", "contracts"],
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "minLength": 2,
      "maxLength": 50,
      "description": "Skill name in kebab-case format (lowercase with hyphens). Must start with a letter. Examples: 'dotnet-build', 'code-format', 'run-tests'.",
      "examples": ["dotnet-build", "code-format", "dotnet-test", "code-analyze"]
    },
    "version": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
      "description": "Semantic version following semver format (MAJOR.MINOR.PATCH). May include pre-release and build metadata.",
      "examples": ["0.1.0", "1.2.3", "2.0.0-beta.1", "1.0.0+20231101"]
    },
    "kind": {
      "type": "string",
      "enum": ["cli", "mcp", "http", "script", "composite"],
      "description": "Type of skill execution mechanism. 'cli' for command-line tools, 'mcp' for Model Context Protocol servers, 'http' for API calls, 'script' for shell/PowerShell scripts, 'composite' for skills that combine multiple other skills.",
      "examples": ["cli", "mcp", "script"]
    },
    "description": {
      "type": "string",
      "minLength": 20,
      "maxLength": 300,
      "description": "Clear, concise description of what the skill does and when to use it. Must be between 20-300 characters. Should include the trigger condition (WHEN to use this skill).",
      "examples": [
        "Build .NET solution/projects using dotnet CLI. Use when task involves compiling, restoring dependencies, or building artifacts.",
        "Format code using dotnet-format and Prettier. Use when code style needs to be corrected or standardized."
      ]
    },
    "inputs": {
      "type": "object",
      "description": "Optional input parameters the skill accepts. Each key is a parameter name, and the value describes valid options or types.",
      "additionalProperties": {
        "oneOf": [
          {
            "type": "array",
            "items": { "type": "string" }
          },
          { "type": "string" }
        ]
      },
      "examples": [
        {
          "target": ["solution", "project", "all"],
          "configuration": ["Debug", "Release"],
          "project_path": "string"
        }
      ]
    },
    "outputs": {
      "type": "object",
      "description": "Optional outputs the skill produces. Describes artifacts, files, or data generated by the skill.",
      "additionalProperties": true,
      "examples": [
        {
          "artifacts": "Compiled binaries in bin/ directory",
          "logs": "Build output with warnings and errors"
        }
      ]
    },
    "contracts": {
      "type": "object",
      "required": ["success", "failure"],
      "description": "Defines success and failure conditions for the skill. Helps agents understand when the skill completed successfully or failed.",
      "properties": {
        "success": {
          "type": "string",
          "minLength": 10,
          "maxLength": 200,
          "description": "Clear criteria for successful skill execution. Should be observable and verifiable.",
          "examples": [
            "Build completes with zero errors; artifacts in bin/",
            "All tests pass; coverage report generated",
            "Code formatted successfully; no style violations"
          ]
        },
        "failure": {
          "type": "string",
          "minLength": 10,
          "maxLength": 200,
          "description": "Clear criteria for failed skill execution. Should help diagnose what went wrong.",
          "examples": [
            "Non-zero exit code or compilation errors",
            "Tests failed or coverage below threshold",
            "Format errors or incompatible code"
          ]
        }
      },
      "additionalProperties": false
    },
    "dependencies": {
      "type": "array",
      "description": "Optional list of other skills or tools this skill depends on.",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "examples": [["dotnet-restore", "dotnet-clean"]]
    },
    "tags": {
      "type": "array",
      "description": "Optional tags for categorization and discovery.",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9-]+$"
      },
      "uniqueItems": true,
      "examples": [
        ["build", "dotnet", "compilation"],
        ["test", "coverage", "quality"]
      ]
    },
    "references": {
      "type": "array",
      "description": "Optional list of reference files in the references/ subdirectory.",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "examples": [["build-solution.md", "restore-deps.md", "run-benchmarks.md"]]
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "name": "dotnet-build",
      "version": "0.2.0",
      "kind": "cli",
      "description": "Build .NET solution/projects using dotnet CLI. Use when task involves compiling, restoring dependencies, or building artifacts.",
      "inputs": {
        "target": ["solution", "project", "all"],
        "configuration": ["Debug", "Release"],
        "project_path": "string"
      },
      "contracts": {
        "success": "Build completes with zero errors; artifacts in bin/",
        "failure": "Non-zero exit code or compilation errors"
      },
      "tags": ["build", "dotnet", "compilation"],
      "references": ["build-solution.md", "restore-deps.md"]
    }
  ]
}
